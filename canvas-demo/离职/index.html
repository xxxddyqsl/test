<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>打印</title>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <style type="text/css" media="print">
        @page {
            /* 去除页眉页脚纵向打印 */
            size: auto;
            /* auto is the initial value */
            /*去除页眉页脚*/
            margin: 0mm;
            /* this affects the margin in the printer settings */
            margin-top: 6mm;
            /* 左右 边距 */
            margin-left: 10mm;
            margin-right: 10mm;
            /* margin-bottom: 1mm; */
            size: portrait;
        }
    </style>
    <style type="text/css">
        html,
        body {
            margin: 0;
            padding: 0;
        }

        #wraper {
            width: 850px;
            /* height: 1271px; */
            height: 1230px;
            margin: 0 auto;
            text-align: center;
        }

        .header {
            width: 800px;
            margin: 0 auto;

        }

        .header_img {
            width: 800px;
        }

        .main {
            width: 800px;
            margin: 0 auto;
            font-family: '华文仿宋';
        }

        .footer {
            font-family: '华文仿宋';
            display: flex;
            width: 800px;
            font-size: 15px;
            text-align: left;
            padding-top: 8px;
            margin: 0 auto;
            border-top: 1px solid #e1e1e3;
            color: #818181;
        }

        .footer_left {
            margin-right: auto;
        }

        .main_header_title {
            font-size: 29px;
            margin-top: 32px;
            text-align: center;
            font-family: '黑体';
        }


        .main_conten {
            margin-top: 32px;
            text-align: left;
            /* margin-left: 18px; */
            /* 首行缩进举例如下（根据你页面中字体的大小，如页面中字体是12px，缩进2个字符就是24px */
            text-indent: 43.4px;
            line-height: 45px;
            /* font-size: 18.7px; */
            font-size: 21.7px;
        }

        .main_conten_bottom_border {
            padding: 0 16px 2px 16px;
            border-bottom: 1px solid #000;
        }

        .main_conten_DividingLine {
            position: relative;
            margin: 10px 0;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            margin-bottom: 0;
        }

        .main_conten_DividingLine::after {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            width: 100%;
            transform: translate(0%, -50%);
            border-top: 1px dashed;
        }

        .main_conten_DividingLine_title {
            padding: 0 10px;
            background-color: #fff;
            margin: 0 auto;
            position: absolute;
            z-index: 2;
            /* 去除首行缩进 */
            text-indent: 0;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>

<body>
    <!--startprint1-->
    <!--打印内容开始-->
    <div id="wraper" style="text-align:center;">
        <div class="header">

        </div>
        <div class="main">


        </div>
        <div class="footer">

            <!-- 苏州蜗牛数字科技股份有限公司 Suzhou Snail Digital Technology Co.,Ltd. -->
            <div class="footer_left"></div>
            <div class="footer_right"></div>
        </div>
    </div>
    <!--打印内容结束-->
    <!--endprint1-->
</body>
<!-- http://172.18.70.26:8088/project/www/canvas-demo/%E7%A6%BB%E8%81%8C/index.html?code=341222198407050291&name=吕小龙&gender=先生&join_date=2017-08-24&dimission_date=2018-09-25&position_name=IT高级经理&company=sz&dimission_reason=个人原因&open_date=2019-05-16-->

<script>
    'use strict';
    window.onload = function () {
        // 获取url后的参数数据
        var str = decodeURI(window.location.href.split('?')[1]);
        var json = {};
        for (var i = 0; i < str.split('&').length; i++) {
            json[str.split('&')[i].split('=')[0]] = str.split('&')[i].split('=')[1]
        }
        var img = new Image();
        var node = document.querySelector('.header');
        if (json.company == "sz") {
            img.src = './image/snailgame.png';
            img.className = 'header_img';
            // node.src = './image/snailgame.png';
            document.querySelector('.footer_left').innerHTML = '苏州蜗牛数字科技股份有限公司';
            document.querySelector('.footer_right').innerHTML = '人力资源中心';
        }
        if (json.company.indexOf('yd_') >= 0) {
            img.src = './image/mobile-suzhou.png';
            img.className = 'header_img';
            if (json.company.indexOf('yd_sz') >= 0) {
                document.querySelector('.footer_left').innerHTML = '世纪蜗牛通信科技有限公司苏州分公司';
            } else if (json.company.indexOf('yd_bj') >= 0) {
                document.querySelector('.footer_left').innerHTML = '世纪蜗牛通信科技有限公司';
            }
            document.querySelector('.footer_right').innerHTML = '人力资源中心';
        }
        img.onload = function () {
            // 获取图片的原始尺寸  img.naturalWidth  img.naturalHeight
            var Proportion = (img.naturalWidth / img.naturalHeight);//比例
            // console.log(img,Proportion,img.naturalWidth ,img.naturalHeight)
            img.style.height = (node.clientWidth / Proportion) + 'px';
            // 页眉 img标签设置完成之后 推入标签
            node.appendChild(img);
            // 调用数据渲染页面主体内容
            renderHtml(json);

        };
    }



    function renderHtml(msg) {
        console.log(msg);
        // 设置主体内容 高度 页脚撑到底部
        $('.main').css('height', ($('#wraper').height() - $('.header').outerHeight() - $('.footer').outerHeight() + 'px'));
        let html = `
        <div class="main_header_title">离职证明(个人联)</div>
            <div class="main_conten">
                兹证明：
                <span class="main_conten_bottom_border">${msg.name}</span>
                ${msg.gender}，身份证号： <span class="main_conten_bottom_border">${msg.code}</span>。
                于<span class="main_conten_bottom_border">${msg.join_date.split('-')[0]}</span>年<span
                    class="main_conten_bottom_border">${msg.join_date.split('-')[1]}</span>月<span
                    class="main_conten_bottom_border">${msg.join_date.split('-')[2]}</span>日入职我公司，担任<span class="main_conten_bottom_border">${msg.position_name}</span>一职。现因<span class="main_conten_bottom_border">${msg.dimission_reason}</span>提出离职，
                    并于<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[0]}</span>年<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[1]}</span>月<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[2]}</span>日正式离职。劳动关系自正式离职之日起解除。
                    <!-- <br> -->
                    <div style="margin-top: 8px;">特此证明。</div>
                    <div style=" margin-top: 60px;text-align: center;display: flex;margin-right: 22px;">
                        <span style="margin-left: auto;">
                           <div style='text-indent: 0;'>${msg.company == "sz" ? '苏州蜗牛数字科技股份有限公司' :msg.company == "yd_bj" ? '世纪蜗牛通信科技有限公司' : msg.company == "yd_sz" ? '世纪蜗牛通信科技有限公司苏州分公司' : ''}</div>                            
                            <span>人力资源中心</span>
                           <br>
                           <span class="main_conten_bottom_border">${msg.dimission_date.split('-')[0]}</span>年<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[1]}</span>月<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[2]}</span>日
                        </span>
                    </div>
                    <div style='text-indent: 0;text-align: center;margin-top: 26px;font-family: "宋体"; font-size: 15.7px;'>此证明仅开具一份，请注意妥善保管。如因个人原因遗失，公司不予补开。</div>
                    <div class="main_conten_DividingLine">
                        <div class="main_conten_DividingLine_title">(盖骑缝章)</div>
                    </div>
            </div>
            <div class="main_header_title">离职证明(存根联)</div>
            <div class="main_conten">
                兹有<span class="main_conten_bottom_border">${msg.name}</span>${msg.gender}
                ，身份证号： <span class="main_conten_bottom_border">${msg.code}</span>，
                于<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[0]}</span>年<span
                    class="main_conten_bottom_border">${msg.dimission_date.split('-')[1]}</span>月<span
                    class="main_conten_bottom_border">${msg.dimission_date.split('-')[2]}</span>日正式离职。
                    <div>
                        双方就劳动关系存续期间的所有权利义务（包括但不限于工资、加班、奖金、年假及社保等）不存在任何争议，但如因离职人未妥善完成工作交接或因其在职期间个人失误而给公司造成损失的，本公司保留追究其法律责任的权利。
                    </div>
                    <div style=" margin-top: 50px;text-align: center;display: flex;margin-right: 22px;">
                        <span style="margin-left: auto;">
                           <div style="width: 100%;
                           text-indent: 0;    margin-bottom: 16px;
                           display: flex;">个人签收:<span class="main_conten_bottom_border" style="flex: 1;"></span></div>
                           <!-- <br> -->
                           <div style="width: 100%;
                           text-indent: 0;    margin-bottom: 16px;
                           display: flex;">签收日期:<span style="flex: 1;"><span class="main_conten_bottom_border">${msg.dimission_date.split('-')[0]}</span>年<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[1]}</span>月<span class="main_conten_bottom_border">${msg.dimission_date.split('-')[2]}</span>日</span></div>
                        </span>
                    </div>

            </div>
        `;
        $('.main').append(html);
        preview(1)
    };
    // 打印
    function preview(oper) {
        if (oper < 10) {
            var bdhtml = window.document.body.innerHTML; //获取当前页的html代码
            var sprnstr = "<!--startprint" + oper + "-->"; //设置打印开始区域
            var eprnstr = "<!--endprint" + oper + "-->"; //设置打印结束区域
            var prnhtml = bdhtml.substring(bdhtml.indexOf(sprnstr) + 18); //从开始代码向后取html
            prnhtml = prnhtml.substring(0, prnhtml.indexOf(eprnstr)); //从结束代码向前取html
            window.document.body.innerHTML = prnhtml;
            window.print();
            window.document.body.innerHTML = bdhtml;
        } else {
            window.print();
        }
    };
</script>



</html>