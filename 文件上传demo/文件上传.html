<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/common.css" />
    <script type="text/javascript" src="./js/navigator.js"></script>
    <script type="text/javascript" src="./js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="./js/public.js"></script>
    <script type="text/javascript" src="./js/laydate/laydate.js"></script>
    <script type="text/javascript" src="./js/layer/layer.js"></script>
    <script type="text/javascript" src="index.js"></script>
    <script type="text/javascript" src="./js/spark-md5.min.js"></script>
</head>

<body>
<div>
    <ul class="file_con">
        <li class="addIcon" onclick='upload()' id="16"></li>

    </ul>
</div>
  


    <input type="file" id="myupload" style="display: none;" class="displayNone"
        accept="image/png, image/jpeg, image/gif, image/jpg, .doc, .docx, .txt, .xlsx, .xls">
</body>
<script>
    window.onload = () => {
        // $('input[type=file]').click();
        // $('input[type=file]').on('change', function () {
        //     console.log(this)
        //     console.log(this.files);
        // })
    };
    var running;
    function upload(){
        // 获取当前点击的元素对象
        let e=window.event || arguments.callee.caller.arguments[0];
        var id = $(e.target).attr('id');
        var code = $(e.target).data('code');
        code == 'undefined' ? code = null : null;
        // unbind() 移除 input 上传 元素的事件处理器
        $('input[type=file]').unbind();
        // change  监听 input 上传
        $('input[type=file]').on('change', function () {
            if (!running) {
                if(!this.files){
                    alert('当前浏览器暂不支持上传功能！')
                } else if (this.files[0].size > 1024*1024*10) {
                    alert('文件最大为10M！');
                }else {
                    getMD5(this.files[0], id, code);
                }
            } else {
                alert('当前有一个文件正在上传，请稍后！');
                return;
            }
           
            // console.log(this)
            // console.log(this.files);
            this.value = '';
            if (this.outerHTML) {
                this.outerHTML = this.outerHTML;
            }
        })
        $('input[type=file]').click();
    }
    // 校验 字符串 是否是JSON字符串 
    function isJSON_test(str) {
        if (typeof str == 'string') {
            try {
                if (JSON.parse(str) && JSON.parse(str).type && JSON.parse(str).type == 'new_EMPLOYEE') {
                    console.log('转换成功：' + JSON.parse(str)); 
                    alert('转换成功：'); 
                } else {
                   var b=bbbb;
                }
            } catch (e) {
                console.log('error：' + str + '!!!' + e); 
            }
        }
        console.log('It is not a string!')
    }; 
</script>

</html>